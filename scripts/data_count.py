import numpy as np

def calculate_metrics_average_multi(methods_data):
    """
    Calculate the average of metrics for multiple methods, excluding None values.

    Args:
        methods_data (list): List of dictionaries with 'name' and metrics ('coverage', 
                            'select_state_accuracy', 'arrive_assigned_coverage_time').

    Returns:
        dict: Dictionary with method names as keys and average metrics as values.
    """
    results = {}
    
    for method_data in methods_data:
        method_name = method_data.get('name', 'Unnamed')
        averages = {}
        
        # Calculate average for coverage
        coverage = [x for x in method_data['data']['coverage'] if x is not None]
        averages['coverage'] = np.mean(coverage) if coverage else None
        
        # Calculate average for select_state_accuracy
        select_state_accuracy = [x for x in method_data['data']['select_state_accuracy'] if x is not None]
        averages['select_state_accuracy'] = np.mean(select_state_accuracy) if select_state_accuracy else None
        
        # Calculate average for arrive_assigned_coverage_time
        arrive_assigned_coverage_time = [x for x in method_data['data']['arrive_assigned_coverage_time'] if x is not None]
        averages['arrive_assigned_coverage_time'] = np.mean(arrive_assigned_coverage_time) if arrive_assigned_coverage_time else None
        
        results[method_name] = averages
    
    return results
 
if __name__ == "__main__":
    # Data for SymFlow and baselines
    methods_data = [
        {
            'name': 'SymFlow',
            'data': {'coverage': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9878048780487805, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.7364341085271318, 0.9830508474576272, 1.0, 1.0, 1.0, 1.0, 0.9365079365079365, 1.0, 1.0, 1.0, 0.9444444444444444, 1.0, 1.0, 0.5920826161790017, 1.0, 0.7071651090342679, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.24206349206349206, 1.0, 0.6467991169977925, 1.0, 1.0, 0.9285714285714286, 1.0, 1.0, 0.9888888888888889, 0.5906593406593407, 1.0, 1.0, 0.437984496124031, 1.0, 0.3094262295081967, 1.0, 1.0, 1.0, 1.0, 1.0, 0.946236559139785, 0.9342105263157895, 0.8921568627450981, 0.875, 1.0, 1.0, 1.0, 0.9327354260089686, 0.9408602150537635, 0.8873239436619719, 1.0, 0.31176470588235294, 1.0, 1.0, 1.0, 1.0, 1.0, 0.29245283018867924, 0.987012987012987, 1.0, 1.0, 1.0, 0.8391608391608392, 1.0, 1.0, 1.0, 0.28807947019867547, 0.9465020576131687, 0.31929046563192903, 0.27735849056603773, 0.2831858407079646, 1.0, 0.8744769874476988, 1.0, 1.0, 0.5273972602739726, 1.0, 1.0, 1.0, 1.0, 0.7540983606557377, 1.0, 1.0, 1.0, 1.0, 1.0, 0.30666666666666664, 1.0, 0.6, 1.0, 1.0, 1.0, 1.0, 0.9478672985781991, 1.0, 1.0, 0.9830508474576272, 0.9830508474576272, 0.9821428571428571, 1.0, 0.9719626168224299, 1.0, 0.48398576512455516, 0.489247311827957, 1.0, 1.0, 1.0, 1.0, 0.8431372549019608, 1.0, 1.0, 1.0, 1.0, 0.7851239669421488, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5174825174825175, 1.0, 1.0, 0.9830508474576272, 0.9823529411764705, 1.0, 0.5384615384615384, 0.926605504587156, 1.0, 1.0, 1.0, 1.0, 0.9830508474576272, 1.0, 1.0], 'select_state_accuracy': [0.8809523809523809, 0.9473684210526315, 0.8527131782945736, 0.7073170731707317, 0.8264462809917356, 0.8617021276595744, 0.7586206896551724, 0.9473684210526315, 0.5190839694656488, 0.7741935483870968, 0.967741935483871, 0.8372093023255814, 0.8372093023255814, 0.7209302325581395, 0.5742574257425742, 0.5547445255474452, 0.9473684210526315, 0.8527131782945736, 0.9852941176470589, 0.9722222222222222, 0.9473684210526315, 0.9863013698630136, 1.0, 0.9433962264150944, 0.967741935483871, 0.8125, 0.7209302325581395, 0.7209302325581395, 0.945054945054945, 0.7985074626865671, 0.9473684210526315, 0.8875, 0.9879518072289156, 0.5547445255474452, 0.8780487804878049, 1.0, 0.9523809523809523, 0.7731958762886598, 0.8888888888888888, 0.6867469879518072, 0.9066666666666666, 0.9767441860465116, 0.9473684210526315, 0.896551724137931, 0.9696969696969697, 0.9574468085106383, 0.9473684210526315, 0.8235294117647058, 0.94, 0.7727272727272727, 0.9090909090909091, 0.9777777777777777, 0.8681318681318682, 0.9705882352941176, 0.9078947368421053, 0.8043478260869565, 0.6266666666666667, 0.8181818181818182, 0.9764705882352941, 0.9342105263157895, 0.8611111111111112, 0.8611111111111112, 0.8202247191011236, 0.7066666666666667, 0.7209302325581395, 0.9302325581395349, 0.9207920792079208, 0.9625, 0.9529411764705882, 0.816793893129771, 0.9473684210526315, 0.9777777777777777, 1.0, 0.9642857142857143, 0.9875, 0.5547445255474452, 1.0, 0.9523809523809523, 0.9523809523809523, 0.9787234042553191, 0.44086021505376344, 0.782608695652174, 0.972972972972973, 0.6774193548387096, 0.28859060402684567, 0.9111111111111111, 0.967741935483871, 0.9512195121951219, 0.9629629629629629, 0.9595959595959596, 0.7160493827160493, 0.984375, 1.0, 0.9866666666666667, 1.0, 0.9722222222222222, 0.8809523809523809, 0.8831168831168831, 0.9473684210526315, 0.9777777777777777, 0.9433962264150944, 0.9411764705882353, 0.9090909090909091, 0.7209302325581395, 0.5547445255474452, 0.8857142857142857, 0.8181818181818182, 0.7209302325581395, 0.5547445255474452, 0.5686274509803921, 0.6612903225806451, 0.6031746031746031, 0.7676767676767676, 0.9, 0.7209302325581395, 0.8924731182795699, 0.9629629629629629, 0.5474452554744526, 0.9230769230769231, 0.9473684210526315, 0.8527131782945736, 0.9142857142857143, 0.9142857142857143, 0.7619047619047619, 0.9066666666666666, 0.9076923076923077, 0.9655172413793104, 0.90625, 0.9361702127659575, 0.967741935483871, 0.7659574468085106, 0.6266666666666667, 0.9743589743589743, 0.9863013698630136, 0.75, 0.6266666666666667, 0.9743589743589743, 0.7311827956989247, 0.9090909090909091, 0.6266666666666667, 0.9743589743589743, 0.7209302325581395, 0.9732142857142857, 0.9655172413793104, 0.9818181818181818, 0.978021978021978, 0.5474452554744526, 0.953125, 0.967741935483871, 0.8125, 0.9347826086956522, 0.9625, 0.7209302325581395, 0.9692307692307692, 0.8695652173913043, 0.918918918918919, 0.9473684210526315, 0.5547445255474452, 0.8817204301075269, 0.9166666666666666, 0.967741935483871, 0.8125], 'arrive_assigned_coverage_time': [None, 6.775592803955078, 36.82747483253479, 9.769782066345215, 51.20388603210449, 50.39909100532532, 35.28120803833008, 6.872680187225342, 21.104666233062744, 206.1949977874756, 14.918623924255371, 35.70834994316101, 213.00032091140747, 11.071488857269287, 42.45198583602905, 24.4709050655365, 7.180978775024414, 47.16099715232849, 112.89704823493958, 139.88170170783997, 6.916017770767212, 150.9202139377594, 186.40393209457397, 209.24040293693542, 15.414364099502563, 14.828463077545166, 10.492933750152588, 13.738362789154053, 61.7928900718689, 51.04711103439331, 7.08995509147644, 61.979822874069214, 69.24176573753357, 28.18974494934082, 47.220906019210815, None, 9.91579794883728, None, 3.700676202774048, None, 24.576682806015015, 20.528323888778687, 7.460175037384033, 7.162046909332275, 16.30875301361084, None, 6.668286085128784, None, 25.268068075180054, 6.8179779052734375, 129.30061388015747, 23.63589310646057, 44.906440019607544, 202.12589478492737, None, 144.6004719734192, 20.674455881118774, None, 69.56869387626648, None, 13.497623205184937, 23.2495596408844, 45.112213134765625, 25.0522940158844, 10.039582252502441, 86.52433896064758, 71.96068906784058, 99.44432783126831, 86.88993692398071, 40.24891185760498, 8.444620847702026, 24.23327112197876, 120.49871110916138, 91.8010802268982, 96.72804188728333, 22.338191986083984, None, 10.722591876983643, 7.085129976272583, 23.401970148086548, 24.539714097976685, 41.423667907714844, None, 54.8906729221344, 24.82758903503418, 35.72068810462952, 16.617329120635986, 104.27615904808044, 16.79523777961731, 52.12009811401367, 57.86684584617615, None, 126.4607412815094, None, None, None, 45.60888600349426, 161.43999004364014, 8.030742883682251, 28.484688997268677, None, 18.824383974075317, 61.60850715637207, 10.319830179214478, 23.95085906982422, 103.30941081047058, None, 11.752681970596313, 24.864291667938232, 46.860864877700806, 37.640756130218506, None, 27.64391803741455, 135.63380908966064, 11.346033811569214, 54.21518278121948, 14.363539934158325, 21.072556972503662, 106.64493799209595, 7.905150890350342, 40.26357102394104, 39.11098384857178, None, 180.5069398880005, 27.64931082725525, 114.13962960243225, 47.74715995788574, None, None, 18.319901943206787, 81.04103994369507, 21.974298000335693, 16.66590690612793, 146.96971321105957, 60.92001008987427, 27.191600799560547, 14.532248735427856, 57.66311812400818, None, 25.52943706512451, 21.001271963119507, 10.57398796081543, 44.68359613418579, 17.95081377029419, 28.032967805862427, 61.10872292518616, 24.730559825897217, 174.15430402755737, 15.662167072296143, 16.412490844726562, 253.24437189102173, 296.5483601093292, 12.411713123321533, None, 52.11098766326904, 19.624026775360107, 16.96555519104004, 21.468492031097412, 71.19198489189148, None, 10.84857177734375, 15.564429998397827]}
        },
        {
            'name': 'learch',
            'data': {'coverage': [0.3380281690140845, 1.0, 1.0, 1.0, 0.9052631578947369, 1.0, 1.0, 1.0, 1.0, 0.7474747474747475, 1.0, 0.9482758620689655, 0.7073170731707317, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9466666666666667, 1.0, 0.9180327868852459, 0.7751937984496124, 0.6101694915254238, 1.0, 1.0, 1.0, 1.0, 0.8888888888888888, 1.0, 1.0, 0.865546218487395, 0.9166666666666666, 1.0, 0.9655172413793104, 0.20654044750430292, 1.0, 0.34579439252336447, 1.0, 0.45652173913043476, 1.0, 1.0, 1.0, 1.0, 1.0, 0.19047619047619047, 1.0, 0.20309050772626933, 1.0, 1.0, 0.5928571428571429, 1.0, 1.0, 0.7851851851851852, 0.4807692307692308, 0.9615384615384616, 1.0, 0.4263565891472868, 1.0, 0.2786885245901639, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8978494623655914, 0.9210526315789473, 0.9019607843137255, 0.8693181818181818, 1.0, 1.0, 1.0, 0.9013452914798207, 0.9139784946236559, 0.8685446009389671, 1.0, 0.1676470588235294, 1.0, 1.0, 1.0, 1.0, 1.0, 0.3915094339622642, 1.0, 1.0, 1.0, 1.0, 0.7552447552447552, 1.0, 1.0, 1.0, 0.3162251655629139, 0.8600823045267489, 0.35476718403547675, 0.33962264150943394, 0.2424778761061947, 1.0, 0.7489539748953975, 1.0, 1.0, 0.3356164383561644, 1.0, 0.9629629629629629, 1.0, 1.0, 0.819672131147541, 0.3620689655172414, 1.0, 1.0, 1.0, 1.0, 0.09555555555555556, 1.0, 0.5513513513513514, 1.0, 1.0, 1.0, 1.0, 0.7203791469194313, 1.0, 1.0, 0.9322033898305084, 0.2033898305084746, 0.6607142857142857, 1.0, 0.616822429906542, 1.0, 0.34519572953736655, 0.4946236559139785, 1.0, 0.8589743589743589, 1.0, 1.0, 0.6862745098039216, 0.9230769230769231, 1.0, 1.0, 1.0, 0.39669421487603307, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6713286713286714, 1.0, 1.0, 0.6101694915254238, 0.5117647058823529, 1.0, 0.358974358974359, 0.944954128440367, 1.0, 1.0, 1.0, 1.0, 0.3898305084745763, 1.0, 1.0], 'select_state_accuracy': [0.4112903225806452, 0.9473684210526315, 0.8604651162790697, 0.7317073170731707, 0.2457627118644068, 0.14271356783919598, 0.5925925925925926, 0.9473684210526315, 0.5267175572519084, 0.7447916666666666, 0.967741935483871, 0.4857142857142857, 0.8598130841121495, 0.7441860465116279, 0.10104861773117255, 0.5474452554744526, 0.9473684210526315, 0.8604651162790697, 0.2229038854805726, 0.2492046659597031, 0.9473684210526315, 0.4629032258064516, 0.966183574879227, 0.74235807860262, 0.967741935483871, 0.8333333333333334, 0.7441860465116279, 0.7441860465116279, 0.38095238095238093, 0.6091370558375635, 0.9473684210526315, 0.3661417322834646, 0.34657039711191334, 0.5474452554744526, 0.6910569105691057, 0.3477956613016095, 0.9523809523809523, 0.235509904622157, 0.8888888888888888, 0.24483985765124555, 0.9066666666666666, 0.9767441860465116, 0.9473684210526315, 0.896551724137931, 0.9696969696969697, 0.953125, 0.9473684210526315, 0.9005847953216374, 0.96, 0.7727272727272727, 0.6421404682274248, 0.9777777777777777, 0.8791208791208791, 0.581294964028777, 0.968, 0.8125, 0.64, 0.9769230769230769, 0.17635270541082165, 0.9936708860759493, 0.8888888888888888, 0.8888888888888888, 0.7248322147651006, 0.72, 0.7441860465116279, 0.22930542340627974, 0.13450704225352111, 0.2821387940841866, 0.26119402985074625, 0.6091370558375635, 0.9473684210526315, 0.9777777777777777, 0.3449101796407186, 0.3125, 0.34656084656084657, 0.5474452554744526, 0.972972972972973, 0.9523809523809523, 0.9523809523809523, 0.9787234042553191, 0.031623602005399154, 0.09808612440191387, 0.9841269841269841, 0.3547400611620795, 0.09038461538461538, 0.9111111111111111, 0.967741935483871, 0.943502824858757, 0.9629629629629629, 0.9595959595959596, 0.19534282018111254, 1.0, 0.6613545816733067, 1.0, 1.0, 1.0, 0.18929503916449086, 0.8541033434650456, 0.9473684210526315, 0.9777777777777777, 0.9634146341463414, 0.9411764705882353, 0.8, 0.7441860465116279, 0.5474452554744526, 0.8421052631578947, 0.8155339805825242, 0.7441860465116279, 0.5474452554744526, 0.10463968410661402, 0.5079365079365079, 0.9294871794871795, 0.7676767676767676, 0.5044510385756676, 0.7441860465116279, 0.1561822125813449, 0.9629629629629629, 0.5474452554744526, 0.5557620817843866, 0.9473684210526315, 0.8604651162790697, 0.6776859504132231, 0.6776859504132231, 0.9242424242424242, 0.92, 0.8712121212121212, 0.9655172413793104, 0.9784172661870504, 0.9583333333333334, 0.967741935483871, 0.7463768115942029, 0.64, 0.9743589743589743, 0.7792792792792793, 0.6973684210526315, 0.64, 0.9743589743589743, 0.10612244897959183, 0.9537037037037037, 0.64, 0.9743589743589743, 0.7441860465116279, 0.6280193236714976, 0.9655172413793104, 0.9818181818181818, 0.6666666666666666, 0.5474452554744526, 0.95, 0.967741935483871, 0.8333333333333334, 0.8461538461538461, 0.5102040816326531, 0.7441860465116279, 0.9636363636363636, 0.764102564102564, 0.8918918918918919, 0.9473684210526315, 0.5474452554744526, 0.46685082872928174, 0.8461538461538461, 0.967741935483871, 0.8333333333333334], 'arrive_assigned_coverage_time': [67.10445213317871, 6.882784128189087, 46.89913606643677, 11.174530982971191, 58.37075591087341, 59.72905230522156, 50.21458697319031, 13.092232942581177, 27.324882984161377, 149.2380611896515, 13.952196836471558, 88.95568013191223, 163.76159000396729, 11.090235948562622, 39.89107036590576, 32.025193214416504, 8.489984035491943, 50.96356201171875, 133.1091570854187, 133.84869122505188, 6.934468030929565, 152.47919988632202, 194.93846917152405, 160.80148482322693, 15.039047002792358, 23.798534870147705, 11.015979051589966, 10.972572803497314, 67.5418541431427, 45.21206498146057, 7.424893856048584, 69.74971795082092, 95.9637861251831, 27.97394585609436, 118.67854881286621, 240.26804780960083, 7.034948110580444, 121.46881699562073, 4.206892967224121, 117.4610710144043, 31.618841886520386, 27.446099281311035, 12.63507604598999, 10.762356758117676, 10.530705213546753, None, 7.965161085128784, 230.5280900001526, 25.4002468585968, 8.204447984695435, 78.32947587966919, 24.269229888916016, 52.49556612968445, 184.53225898742676, 260.4475932121277, 152.4762818813324, 23.069804191589355, None, 83.19640874862671, None, 14.355170011520386, 18.51256799697876, 52.273298025131226, 24.282130241394043, 10.95965313911438, 99.02739596366882, 73.64126634597778, 116.1573498249054, 104.29048991203308, 56.872753858566284, 11.158335208892822, 27.788553953170776, 135.80002093315125, 104.5868411064148, 119.17082905769348, 29.740762948989868, None, 7.137757778167725, 10.81290602684021, 26.57427215576172, 29.990597009658813, 47.1570098400116, None, 56.42018270492554, 25.077810049057007, 21.20364999771118, 14.52384090423584, 85.03193187713623, 10.30104398727417, 39.074059009552, 71.56951880455017, None, 141.39934420585632, None, None, None, 64.78783512115479, 213.2049160003662, 7.303965091705322, 23.70685577392578, 173.79766011238098, 8.005266904830933, 188.7070119380951, 10.927264928817749, 27.46153712272644, 204.14522218704224, 172.1368429660797, 11.619672775268555, 31.663007974624634, 43.955626010894775, 31.102703094482422, None, 39.48823308944702, 107.41854095458984, 10.637207269668579, 59.32331418991089, 13.075717210769653, 26.044857025146484, 121.09191489219666, 14.069885015487671, 59.0916690826416, 101.06464719772339, 74.25224304199219, 231.430438041687, 34.54165005683899, 141.13287663459778, 13.747113227844238, None, None, 14.113147258758545, 84.61621189117432, 21.412822008132935, 21.99458599090576, 94.9210958480835, 100.36359691619873, 28.900660037994385, 25.10034990310669, 47.91755533218384, 140.44241404533386, 20.784142017364502, 21.683765172958374, 10.606602191925049, 48.64419984817505, 13.343294143676758, 30.473257780075073, 54.7315559387207, 28.533975839614868, 293.94406914711, 13.614522933959961, 14.834015846252441, 163.06262516975403, 125.13401699066162, 11.977940082550049, 221.23419904708862, 70.23943209648132, 15.369853258132935, 10.337162017822266, 30.157633066177368, 76.44224095344543, 128.41631698608398, 15.525182247161865, 42.23023295402527]}
        },
        {
            'name': 'rss',
            'data': {'coverage': [0.5070422535211268, 1.0, 1.0, 1.0, 0.7263157894736842, 0.7835051546391752, 0.9866666666666667, 1.0, 1.0, 0.23232323232323232, 1.0, 0.603448275862069, 0.4268292682926829, 1.0, 0.7123287671232876, 1.0, 1.0, 1.0, 0.460431654676259, 0.44666666666666666, 1.0, 0.3879781420765027, 0.2868217054263566, 0.4152542372881356, 1.0, 1.0, 1.0, 1.0, 0.626984126984127, 0.9367088607594937, 1.0, 0.5630252100840336, 0.5416666666666666, 1.0, 0.603448275862069, 0.12736660929432014, 1.0, 0.22118380062305296, 1.0, 0.23043478260869565, 1.0, 1.0, 1.0, 1.0, 1.0, 0.17857142857142858, 1.0, 0.11479028697571744, 1.0, 1.0, 0.39285714285714285, 1.0, 1.0, 0.24074074074074073, 0.17582417582417584, 0.4358974358974359, 1.0, 0.20155038759689922, 0.6504065040650406, 0.1413934426229508, 1.0, 1.0, 0.84375, 1.0, 1.0, 0.41397849462365593, 0.4868421052631579, 0.36764705882352944, 0.44886363636363635, 0.9367088607594937, 1.0, 1.0, 0.34080717488789236, 0.41935483870967744, 0.3568075117370892, 1.0, 0.16470588235294117, 1.0, 1.0, 1.0, 0.6229508196721312, 0.6534653465346535, 0.32547169811320753, 0.7142857142857143, 0.9375, 1.0, 1.0, 0.5104895104895105, 1.0, 1.0, 0.5567010309278351, 0.10099337748344371, 0.2962962962962963, 0.1574279379157428, 0.12641509433962264, 0.12035398230088495, 0.7311827956989247, 0.27615062761506276, 1.0, 1.0, 0.3356164383561644, 1.0, 0.37037037037037035, 1.0, 1.0, 0.47540983606557374, 0.603448275862069, 1.0, 1.0, 0.7123287671232876, 0.875, 0.07777777777777778, 1.0, 0.3621621621621622, 1.0, 0.8041237113402062, 1.0, 1.0, 0.33175355450236965, 1.0, 1.0, 0.5254237288135594, 0.5254237288135594, 0.5535714285714286, 1.0, 0.27102803738317754, 1.0, 0.20284697508896798, 0.23655913978494625, 1.0, 0.4358974358974359, 1.0, 1.0, 0.45751633986928103, 0.4358974358974359, 1.0, 1.0, 0.6896551724137931, 0.4132231404958678, 1.0, 1.0, 1.0, 0.872093023255814, 1.0, 1.0, 0.7575757575757576, 1.0, 0.4125874125874126, 1.0, 1.0, 0.3559322033898305, 0.4176470588235294, 1.0, 0.31794871794871793, 0.6788990825688074, 1.0, 1.0, 1.0, 0.6637168141592921, 0.2796610169491525, 1.0, 1.0], 'select_state_accuracy': [0.4125, 0.9473684210526315, 0.8604651162790697, 0.7073170731707317, 0.29952830188679247, 0.14073339940535184, 0.582010582010582, 0.9473684210526315, 0.5190839694656488, 0.4388185654008439, 0.967741935483871, 0.42162162162162165, 0.36086956521739133, 0.7441860465116279, 0.10568295114656032, 0.5401459854014599, 0.9473684210526315, 0.8604651162790697, 0.15485756026296568, 0.1676923076923077, 0.9473684210526315, 0.27523910733262485, 0.6107660455486542, 0.3423728813559322, 0.967741935483871, 0.8125, 0.7209302325581395, 0.7209302325581395, 0.35650224215246634, 0.6091370558375635, 0.9473684210526315, 0.4037940379403794, 0.34879406307977734, 0.5401459854014599, 0.5194805194805194, 0.07348837209302325, 0.9523809523809523, 0.060216780409474105, 0.8888888888888888, 0.06697362913352867, 0.9066666666666666, 0.9767441860465116, 0.9473684210526315, 0.896551724137931, 0.9696969696969697, 0.3885350318471338, 0.9473684210526315, 0.16575342465753426, 0.96, 0.7272727272727273, 0.5370370370370371, 0.9777777777777777, 0.8571428571428571, 0.21244209133024486, 0.5720823798627003, 0.4190871369294606, 0.6133333333333333, 0.31954887218045114, 0.17166979362101314, 0.37364620938628157, 0.8611111111111112, 0.8888888888888888, 0.6912751677852349, 0.7066666666666667, 0.7441860465116279, 0.08571428571428572, 0.06270411495754409, 0.12111057922450934, 0.1641907740422205, 0.6040609137055838, 0.9473684210526315, 0.9777777777777777, 0.22092115534738485, 0.13870776526378187, 0.17793103448275863, 0.5401459854014599, 0.6857142857142857, 0.9523809523809523, 0.9523809523809523, 0.9787234042553191, 0.017106652587117212, 0.06013119533527697, 0.8837209302325582, 0.4007220216606498, 0.0888468809073724, 0.9333333333333333, 0.967741935483871, 0.9116022099447514, 0.9629629629629629, 0.9595959595959596, 0.20798898071625344, 0.4638447971781305, 0.49514563106796117, 0.454, 0.4675324675324675, 0.5223463687150838, 0.19890260631001372, 0.48518518518518516, 0.9473684210526315, 0.9777777777777777, 0.6052631578947368, 0.9411764705882353, 0.4826086956521739, 0.7209302325581395, 0.5474452554744526, 0.8571428571428571, 0.4727272727272727, 0.7209302325581395, 0.5328467153284672, 0.10728744939271255, 0.5079365079365079, 0.2576419213973799, 0.7676767676767676, 0.48148148148148145, 0.7209302325581395, 0.145769622833843, 0.9629629629629629, 0.5474452554744526, 0.31510791366906477, 0.9473684210526315, 0.8527131782945736, 0.43575418994413406, 0.6296296296296297, 0.46226415094339623, 0.88, 0.1780821917808219, 0.9655172413793104, 0.23295454545454544, 0.5603448275862069, 0.967741935483871, 0.562874251497006, 0.6133333333333333, 0.9743589743589743, 0.25636363636363635, 0.6036585365853658, 0.6133333333333333, 0.9743589743589743, 0.0983858570330515, 0.32673267326732675, 0.6, 0.9743589743589743, 0.7441860465116279, 0.6135265700483091, 0.9655172413793104, 0.9818181818181818, 0.6666666666666666, 0.5474452554744526, 0.6153846153846154, 0.967741935483871, 0.8125, 0.396, 0.5121951219512195, 0.6976744186046512, 0.7205882352941176, 0.5392857142857143, 0.918918918918919, 0.9473684210526315, 0.5474452554744526, 0.47790055248618785, 0.2450592885375494, 0.967741935483871, 0.7916666666666666], 'arrive_assigned_coverage_time': [274.440847158432, 10.831223964691162, 97.13010835647583, 15.963783025741577, 128.4633219242096, 149.7062966823578, 108.68872094154358, 10.79481291770935, 57.56580114364624, None, 18.302117824554443, 200.70265817642212, None, 31.60220503807068, 101.87177014350891, 51.92492890357971, 10.633005857467651, 102.96735620498657, None, None, 12.730468988418579, None, None, None, 19.07632303237915, 21.319097757339478, 16.443326950073242, 18.499297857284546, 213.85637283325195, 107.78212571144104, 14.082581758499146, 263.5816557407379, 279.0181391239166, 67.22359585762024, 248.8860092163086, None, 12.904206991195679, None, 4.531169891357422, None, 46.89413905143738, 33.05311942100525, 9.42560625076294, 14.105621814727783, 22.18932819366455, None, 8.96970009803772, None, 35.62726807594299, 11.797616243362427, None, 35.665729999542236, 69.10526275634766, None, None, None, 33.07503008842468, None, 215.30496382713318, None, 21.91894292831421, 25.089152812957764, 98.34498906135559, 37.42205190658569, 16.439560890197754, None, None, None, None, 116.36090183258057, 11.269425868988037, 47.82736825942993, None, None, None, 60.14622688293457, None, 9.966011047363281, 12.660696029663086, 41.278889179229736, 78.1543779373169, 145.9490361213684, None, 107.62971305847168, 37.997249126434326, 21.342281103134155, 20.77258610725403, 288.7334530353546, 18.910917043685913, 81.96164011955261, 154.84523916244507, None, None, None, None, None, 173.38600325584412, None, 11.219732999801636, 32.488036155700684, None, 10.23082709312439, None, 18.17085289955139, 57.909969091415405, None, 192.6247103214264, 21.938971996307373, 53.52725911140442, 103.43691492080688, 72.56376314163208, None, 52.90388035774231, None, 17.404717206954956, 156.68440508842468, 27.82710075378418, 57.796891927719116, None, 10.00477123260498, 104.20552921295166, 289.0572199821472, 208.5213701725006, 131.2495629787445, 59.12331581115723, None, 19.628649950027466, None, None, 20.96149468421936, None, 38.18968224525452, 34.06716275215149, None, None, 38.974828004837036, 32.4362359046936, 143.9855921268463, None, 38.76946783065796, 32.223095178604126, 16.55074691772461, 128.57230472564697, 18.568962812423706, 50.886871099472046, 166.98806715011597, 55.87092208862305, None, 24.721165895462036, 20.06239104270935, None, None, 17.11518383026123, None, 183.7416808605194, 29.723748683929443, 12.670179843902588, 54.994110107421875, 191.80738186836243, None, 25.529170989990234, 24.037391901016235]}
        }
    ]

    try:
        results = calculate_metrics_average_multi(methods_data)
        print("Average Metrics for Each Method:")
        for method_name, averages in results.items():
            print(f"\n{method_name}:")
            for metric, value in averages.items():
                if value is not None:
                    print(f"  {metric}: {value:.4f}")
                else:
                    print(f"  {metric}: No valid data")
    except Exception as e:
        print(f"Error calculating averages: {str(e)}")